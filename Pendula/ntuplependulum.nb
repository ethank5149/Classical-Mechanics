(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45104,       1153]
NotebookOptionsPosition[     43589,       1125]
NotebookOutlinePosition[     43967,       1141]
CellTagsIndexPosition[     43924,       1138]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<VariationalMethods`\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.798114689915702*^9, 3.7981146931057253`*^9}, {
  3.798115738825379*^9, 
  3.7981157406834784`*^9}},ExpressionUUID->"2dfeff8c-0406-4cef-b9d7-\
e7356052dd96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assuming", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", ">", "0"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"n", ",", "Integers"}], "]"}], ",", 
     RowBox[{"i", ">", "0"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"i", ",", "Integers"}], "]"}], ",", 
     RowBox[{"j", ">", "0"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"j", ",", "Integers"}], "]"}], ",", 
     RowBox[{"l", ">", "0"}], ",", 
     RowBox[{"m", ">", "0"}], ",", 
     RowBox[{"t", ">", "0"}], ",", 
     RowBox[{"g", ">", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.798083358688701*^9, 3.7980834376125593`*^9}, {
  3.798083705812992*^9, 
  3.7980837084290295`*^9}},ExpressionUUID->"a569ae8b-843d-4c77-8627-\
ee7825872ca4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dr", "=", 
   FractionBox["l", "n"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dm", "=", 
   FractionBox["m", "n"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"q", "[", "i", "]"}], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddvars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", "i", "]"}], "''"}], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", "i_", "]"}], "[", "t_", "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"dr", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"y", "[", "i_", "]"}], "[", "t_", "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"dr", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kinetic", "[", "t_", "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "dm", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "i", "]"}], "'"}], "[", "t", "]"}], ")"}], "2"],
         "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "i", "]"}], "'"}], "[", "t", "]"}], ")"}], 
         "2"]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", "t_", "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"dm", " ", "g", " ", 
      RowBox[{
       RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lagrangian", "[", "t_", "]"}], "=", 
   RowBox[{
    RowBox[{"kinetic", "[", "t", "]"}], "-", 
    RowBox[{"potential", "[", "t", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7981139581878757`*^9, 3.798114076313869*^9}, {
   3.798114117242571*^9, 3.7981142074744806`*^9}, {3.7981145062375994`*^9, 
   3.798114517412278*^9}, {3.798114557543544*^9, 3.7981146061864824`*^9}, {
   3.798114680984565*^9, 3.7981146870309315`*^9}, {3.7981149613143263`*^9, 
   3.79811496534013*^9}, {3.7981160999200525`*^9, 3.7981161019740453`*^9}, {
   3.7981254381012187`*^9, 3.798125472577843*^9}, 3.798125520408098*^9, {
   3.7981255514791284`*^9, 
   3.7981255948179336`*^9}},ExpressionUUID->"fe1d2b0b-46b9-4dfd-a145-\
5c04b9041192"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"analyticsol", "=", 
   RowBox[{"EulerEquations", "[", 
    RowBox[{"lagrangian", ",", "vars", ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"analyticsoln", "=", 
   RowBox[{"First", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{"analyticsol", ",", "ddvars"}], "]"}], "]"}]}], ";"}]}], "Input",\
ExpressionUUID->"7510eb1d-484f-4333-bd31-66cad5541bea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"lagrangian", "[", "t", "]"}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"q", "[", "i", "]"}], "'"}], "[", "t", "]"}], "\[Rule]", 
      "s"}]}], ",", "s"}], "]"}], "/.", 
  RowBox[{"s", "\[Rule]", 
   RowBox[{
    RowBox[{"qdot", "[", "i", "]"}], "[", "t", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7981170874004498`*^9, 
  3.7981171839089193`*^9}},ExpressionUUID->"7b376cf9-63ea-4ee6-99b7-\
5708bd588ec4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"k_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     FractionBox[
      RowBox[{"m", " ", 
       SuperscriptBox["l", "2"]}], 
      SuperscriptBox["n", "3"]], " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "j", "]"}], "'"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}]}], 
           ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "k", ",", "n"}], "}"}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qdot", "[", "k_", "]"}], "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox[
      SuperscriptBox["n", "2"], 
      RowBox[{"m", " ", 
       SuperscriptBox["l", "2"]}]], " ", 
     RowBox[{
      RowBox[{"p", "[", "k", "]"}], "[", "t", "]"}]}], "-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"q", "[", "u", "]"}], "'"}], "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"q", "[", "u", "]"}], "[", "t", "]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"q", "[", "u", "]"}], "[", "t", "]"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}]}], ")"}]}],
       ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "1", ",", 
        RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"n", "-", "u"}], "n"], " ", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"q", "[", 
            RowBox[{"k", "+", "v"}], "]"}], "'"}], "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{"k", "+", "v"}], "]"}], "[", "t", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{"k", "+", "v"}], "]"}], "[", "t", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}]}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "1", ",", 
          RowBox[{"n", "-", "k"}]}], "}"}]}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}]}], 
       ")"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.798060908986391*^9, 3.798060995398444*^9}, {
   3.7980610530991344`*^9, 3.798061086097724*^9}, {3.7980616348010883`*^9, 
   3.798061674700856*^9}, {3.7980629760314746`*^9, 3.798063011657756*^9}, {
   3.79806342993291*^9, 3.7980634400229*^9}, {3.7980646949061513`*^9, 
   3.798064699349368*^9}, 3.7980669422832355`*^9, {3.7980698644403515`*^9, 
   3.798069894162403*^9}, 3.798070208297867*^9, {3.798070254998313*^9, 
   3.7980702557196217`*^9}, {3.7980703176864357`*^9, 3.798070459048811*^9}, {
   3.798070753463792*^9, 3.7980708043365173`*^9}, {3.7980709541996984`*^9, 
   3.798071013196579*^9}, {3.7980711334670887`*^9, 3.798071138106879*^9}, {
   3.798071237767801*^9, 3.7980712430698566`*^9}, {3.7980713201510596`*^9, 
   3.798071335551676*^9}, {3.798071516916443*^9, 3.798071521824213*^9}, {
   3.798071583274638*^9, 3.7980715899822083`*^9}, {3.7980720335756235`*^9, 
   3.7980720649365396`*^9}, {3.7980721018576326`*^9, 
   3.7980721111784897`*^9}, {3.7980721495202503`*^9, 
   3.7980721853274555`*^9}, {3.798072262945774*^9, 3.7980722679754505`*^9}, 
   3.798073179723075*^9, 3.798073781778674*^9, {3.798073944287504*^9, 
   3.798073947066434*^9}, {3.798073982046534*^9, 3.798073993537797*^9}, 
   3.7980740613754673`*^9, {3.798074176259554*^9, 3.7980742214091363`*^9}, {
   3.7980742769195137`*^9, 3.798074407730279*^9}, {3.7980744637084293`*^9, 
   3.7980744721893992`*^9}, 3.798080416953472*^9, 3.7980804763169365`*^9, {
   3.798082782977563*^9, 3.798082878754149*^9}, {3.798083318795003*^9, 
   3.798083338084279*^9}, 3.7980837557982564`*^9, {3.7980846672130814`*^9, 
   3.7980847639621687`*^9}, 3.798084991913288*^9, 3.7980850245759974`*^9, {
   3.7981004577951236`*^9, 3.7981004615730267`*^9}, {3.798100508883319*^9, 
   3.798100688526881*^9}, {3.798100732740102*^9, 3.7981007944869404`*^9}, {
   3.7981008752180824`*^9, 3.798100946499237*^9}, {3.7981010238977647`*^9, 
   3.7981011283629274`*^9}, {3.798101620312832*^9, 3.798101727628253*^9}, {
   3.798102708614443*^9, 3.798102771046831*^9}, {3.7981034826544495`*^9, 
   3.798103482950489*^9}, 3.798103698940392*^9, {3.7981037336102996`*^9, 
   3.798103751858859*^9}, {3.798104097932912*^9, 3.798104137353799*^9}, {
   3.798112162333584*^9, 3.798112219747451*^9}, {3.7981131996338067`*^9, 
   3.7981132099165516`*^9}, {3.798116570064948*^9, 3.7981166291823606`*^9}, {
   3.7981256532975492`*^9, 3.798125796019173*^9}, {3.798132513454195*^9, 
   3.7981332250786285`*^9}, {3.7981332660415535`*^9, 3.798133380036668*^9}, {
   3.7981334164245605`*^9, 
   3.7981334168655972`*^9}},ExpressionUUID->"e8fb9a6a-73be-4535-95c8-\
5cd02f65a9ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", "t_", "]"}], "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", 
          SuperscriptBox["l", "2"]}], 
         SuperscriptBox["n", "3"]], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "j", "]"}], "'"}], "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"q", "[", "k", "]"}], "[", "t", "]"}], "]"}]}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "k", ",", "n"}], "}"}]}], "]"}]}], "/.", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "[", "i", "]"}], "[", "t", "]"}], ",", "t"}], "]"}], 
        "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"qdot", "[", "i", "]"}], "[", "t", "]"}], " ", 
         RowBox[{
          RowBox[{"qdot", "[", "i", "]"}], "[", "t", "]"}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "-", 
    RowBox[{"lagrangian", "[", "t", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.798063541121372*^9, 3.7980636755289397`*^9}, {
   3.7980637166591573`*^9, 3.798063906042287*^9}, {3.7980647416040134`*^9, 
   3.7980647612770495`*^9}, {3.798064922387665*^9, 3.798065032414872*^9}, 
   3.7980650949468856`*^9, {3.7980665281769013`*^9, 3.7980665309849033`*^9}, {
   3.7980666017904882`*^9, 3.7980666048086443`*^9}, {3.7980666519057684`*^9, 
   3.798066710969668*^9}, {3.798066810852375*^9, 3.798066819188697*^9}, {
   3.7980669307829494`*^9, 3.7980669331364107`*^9}, 3.798069294752486*^9, 
   3.7980694037218847`*^9, {3.798069473936981*^9, 3.7980695345216846`*^9}, {
   3.7980696217079854`*^9, 3.7980696270812254`*^9}, {3.7980696974664392`*^9, 
   3.7980697600719748`*^9}, 3.798069802468688*^9, {3.7980699179476647`*^9, 
   3.7980699403178196`*^9}, {3.7980700430680046`*^9, 3.79807004860995*^9}, {
   3.798070469714753*^9, 3.798070481739996*^9}, 3.798071018113351*^9, {
   3.798071811412896*^9, 3.798071850053658*^9}, {3.7980719976857295`*^9, 
   3.7980720031150093`*^9}, 3.7980720827939005`*^9, {3.7980721258359704`*^9, 
   3.798072128086096*^9}, 3.7980723091134777`*^9, 3.798073128833206*^9, {
   3.7980745010728307`*^9, 3.7980745255010433`*^9}, {3.7980747908694105`*^9, 
   3.7980748043408155`*^9}, 3.798075085839997*^9, 3.798080524388233*^9, 
   3.798080573013056*^9, {3.7980815423984957`*^9, 3.79808155021068*^9}, 
   3.798082006416626*^9, 3.7980826634713316`*^9, {3.798083840300188*^9, 
   3.7980839088871236`*^9}, {3.798085053038454*^9, 3.798085074573704*^9}, {
   3.798102796956107*^9, 3.798102840387035*^9}, {3.7981037813066263`*^9, 
   3.798103797504261*^9}, {3.798103991372535*^9, 3.7981039976818886`*^9}, {
   3.7981072307685313`*^9, 3.798107255935835*^9}, {3.7981122270976114`*^9, 
   3.7981122563170214`*^9}, {3.7981132181286025`*^9, 
   3.7981132317648745`*^9}, {3.798133439390517*^9, 
   3.79813346600902*^9}},ExpressionUUID->"be3fb85d-a6b3-41ef-b692-\
bd9fb80188ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dq", "[", "i_", "]"}], "[", "t_", "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"H", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], "[", "t", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.798072402346945*^9, 3.79807241051429*^9}, {
   3.798072619235798*^9, 3.798072652014917*^9}, {3.7980726938745375`*^9, 
   3.79807296418861*^9}, {3.7980730480332203`*^9, 3.7980731227478523`*^9}, 
   3.7980731691088533`*^9, {3.798074994660196*^9, 3.7980750390198107`*^9}, {
   3.798075469456629*^9, 3.798075473655677*^9}, {3.7980807868998365`*^9, 
   3.7980807925125484`*^9}, 3.798081978184145*^9, {3.798082705095723*^9, 
   3.7980827289470778`*^9}, 3.7980842345559826`*^9, {3.7980854539290295`*^9, 
   3.798085480563543*^9}, 3.798085579739614*^9, 3.798087297047696*^9, 
   3.798087416690007*^9, {3.798102860464761*^9, 3.79810290860271*^9}, {
   3.798103819927966*^9, 3.7981038201699667`*^9}, {3.7981122597747803`*^9, 
   3.798112267134094*^9}, {3.798113237041427*^9, 
   3.7981132386870813`*^9}},ExpressionUUID->"e81f91de-5e41-4833-a09d-\
871ab93eed38"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dp", "[", "i_", "]"}], "[", "t_", "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"H", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"q", "[", "i", "]"}], "[", "t", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7980729742744913`*^9, 3.7980729744638557`*^9}, {
   3.79807310879498*^9, 3.7980731170427017`*^9}, {3.7980750480102053`*^9, 
   3.798075061604025*^9}, {3.7980754785526314`*^9, 3.7980754894158373`*^9}, {
   3.798080803125636*^9, 3.7980808136186304`*^9}, 3.798081986265976*^9, 
   3.798084246504174*^9, 3.798085595894288*^9, {3.7980872848740215`*^9, 
   3.7980872907495117`*^9}, {3.798087377858818*^9, 3.798087398156991*^9}, {
   3.798102914075257*^9, 3.7981029702408996`*^9}, {3.7981038236447515`*^9, 
   3.7981038345148306`*^9}, {3.7981122693749275`*^9, 
   3.7981122766381617`*^9}, {3.7981132427801714`*^9, 
   3.7981132432033215`*^9}},ExpressionUUID->"04f96491-abf0-40f2-898c-\
7f1b42713431"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tempp", "[", "i_", "]"}], "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"First", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"q", "[", "i", "]"}], "'"}], "[", "t", "]"}], "==", 
       RowBox[{
        RowBox[{"dq", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       RowBox[{"p", "[", "i", "]"}], "[", "t", "]"}]}], "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dtempp", "[", "i_", "]"}], "[", "t_", "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempp", "[", "i", "]"}], "[", "t", "]"}], ",", "t"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"soln", "[", "i_", "]"}], "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"First", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dtempp", "[", "i", "]"}], "[", "t", "]"}], "==", 
        RowBox[{
         RowBox[{"dp", "[", "i", "]"}], "[", "t", "]"}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"tempp", "[", "i", "]"}], "[", "t", "]"}]}]}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"q", "[", "i", "]"}], "[", "t", "]"}], ",", "t", ",", "t"}], 
       "]"}]}], "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reducedsoln", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"First", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"q", "[", "i", "]"}], "[", "t", "]"}], ",", "t", ",", 
            "t"}], "]"}], "\[Equal]", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"soln", "[", "i", "]"}], "[", "t", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "i", "]"}], "[", "t", "]"}], ",", "t", ",", 
           "t"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7981051753224115`*^9, 3.7981052471037717`*^9}, {
   3.798105281104232*^9, 3.7981053958990383`*^9}, {3.7981055915182047`*^9, 
   3.798105595546008*^9}, {3.7981056760078793`*^9, 3.798105728305142*^9}, 
   3.798105758935924*^9, {3.7981058037050543`*^9, 3.798105808022783*^9}, {
   3.798105840902508*^9, 3.798105859398702*^9}, {3.7981061939644957`*^9, 
   3.798106203509963*^9}, {3.798106260868849*^9, 3.798106267519513*^9}, {
   3.798106307276988*^9, 3.798106316159514*^9}, {3.7981063610438333`*^9, 
   3.79810636465329*^9}, {3.798106404760974*^9, 3.79810648537683*^9}, {
   3.7981065188007116`*^9, 3.7981065345958776`*^9}, {3.7981066184885597`*^9, 
   3.798106622129279*^9}, {3.798106718024073*^9, 3.7981068439159365`*^9}, {
   3.7981070426219206`*^9, 3.7981070539668164`*^9}, {3.7981071225598626`*^9, 
   3.798107152040412*^9}, {3.79810741480097*^9, 3.7981074176470003`*^9}, {
   3.798112285392829*^9, 3.7981123547813907`*^9}, {3.7981142439120617`*^9, 
   3.798114246489971*^9}, {3.7981151122509704`*^9, 3.798115113268122*^9}, {
   3.798115159973573*^9, 3.798115160972904*^9}, 3.7981160279743233`*^9, {
   3.798116090496026*^9, 3.7981160922579737`*^9}, {3.7981166403318977`*^9, 
   3.798116647160733*^9}},ExpressionUUID->"6d9eac7d-d0e5-4ed2-967d-\
f138d218e960"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"reducedsoln", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"analytic", "[", "2", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"reducedsoln", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"analytic", "[", "1", "]"}], ")"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7981146457150497`*^9, 3.7981146488788223`*^9}, {
   3.7981149856129184`*^9, 3.7981149908318615`*^9}, {3.7981152136394777`*^9, 
   3.7981152318341403`*^9}, {3.7981152735465302`*^9, 3.798115276822071*^9}, 
   3.79811535673637*^9, {3.7981153949740877`*^9, 3.7981154348641996`*^9}, {
   3.798115865097495*^9, 3.798115875221084*^9}, {3.7981159699047127`*^9, 
   3.7981159706136627`*^9}, {3.7981160328246365`*^9, 3.7981160414112945`*^9}, 
   3.798116073796589*^9, {3.798116113292541*^9, 3.79811613881326*^9}, {
   3.798116193832123*^9, 
   3.7981161939694605`*^9}},ExpressionUUID->"81a55b48-357e-4a8e-8714-\
974aaac0b46a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"q", "[", "1", "]"}], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
        FractionBox[
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"4", " ", "g", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], "l"], 
            "+", 
            FractionBox[
             RowBox[{"8", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                RowBox[{
                 RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
              RowBox[{
               RowBox[{"p", "[", "2", "]"}], "[", "t", "]"}], " ", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"q", "[", "1", "]"}], "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], 
             RowBox[{
              SuperscriptBox["l", "2"], " ", "m"}]], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
               RowBox[{
                RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"q", "[", "1", "]"}], "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], " ", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"q", "[", "2", "]"}], "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "8"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                  RowBox[{
                   RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}]}], 
               "+", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                   RowBox[{
                    RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], ")"}]}], 
                "]"}]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"q", "[", "2", "]"}], "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
               RowBox[{
                RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                    RowBox[{
                    RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], 
                  "-", 
                  RowBox[{
                   FractionBox["1", "2"], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                    RowBox[{
                    RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], ")"}]}], 
                    "]"}]}]}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"q", "[", "1", "]"}], "\[Prime]",
                   MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                  RowBox[{
                   RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], 
                " ", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"q", "[", "1", "]"}], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], " ", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"q", "[", "2", "]"}], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}]}], "+", 
               FractionBox[
                RowBox[{"4", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"g", " ", "l", " ", "m", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], 
                   "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                    RowBox[{
                    RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], 
                    " ", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], "[", "t", "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"q", "[", "2", "]"}], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
                RowBox[{
                 SuperscriptBox["l", "2"], " ", "m"}]]}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], ")"}]}], 
           "]"}]}]]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"q", "[", "2", "]"}], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
        FractionBox[
         RowBox[{
          RowBox[{"32", " ", "g", " ", "l", " ", "m", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}]}], "-", 
             RowBox[{
              RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"96", " ", "g", " ", "l", " ", "m", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"64", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
               RowBox[{
                RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], ")"}]}], 
            "]"}], " ", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"q", "[", "1", "]"}], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["l", "2"], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                RowBox[{
                 RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}]}], 
             "+", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                 RowBox[{
                  RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], ")"}]}], 
              "]"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"q", "[", "1", "]"}], "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
          RowBox[{"128", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
             RowBox[{
              RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"q", "[", "2", "]"}], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["l", "2"], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                RowBox[{
                 RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}]}], 
             "+", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                 RowBox[{
                  RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], ")"}]}], 
              "]"}]}], ")"}], " ", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"q", "[", "1", "]"}], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"q", "[", "2", "]"}], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["l", "2"], " ", "m", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
             RowBox[{
              RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"q", "[", "2", "]"}], "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["l", "2"], " ", "m", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
               RowBox[{
                RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], ")"}]}], 
            "]"}], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"q", "[", "2", "]"}], "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["l", "2"], " ", "m", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"3", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
               RowBox[{
                RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], ")"}]}], 
            "]"}], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"q", "[", "2", "]"}], "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
         RowBox[{"4", " ", 
          SuperscriptBox["l", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                RowBox[{
                 RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], ")"}]}], 
             "]"}]}], ")"}]}]]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7981146505615463`*^9, 3.7981147163269277`*^9, 3.798115013130987*^9, {
   3.7981152635381036`*^9, 3.798115277490515*^9}, 3.7981154380473537`*^9, 
   3.798115771186447*^9, 3.79811581571673*^9, 3.7981159138377075`*^9, 
   3.798115991284551*^9, 3.7981161619245577`*^9, 
   3.7981162270669594`*^9},ExpressionUUID->"df0b6aa5-dcd2-46fc-b3c4-\
311dc3df06e5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"q", "[", "1", "]"}], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "g", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "g", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"l", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"q", "[", "1", "]"}], "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"l", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"q", "[", "2", "]"}], "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
          RowBox[{"l", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                RowBox[{
                 RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], 
              "2"]}], ")"}]}]]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"q", "[", "2", "]"}], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"4", " ", "g", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"4", " ", "g", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "l", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"q", "[", "1", "]"}], "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
           RowBox[{"l", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"q", "[", "2", "]"}], "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
          RowBox[{"l", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
                RowBox[{
                 RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], 
              "2"]}], ")"}]}]]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7981146505615463`*^9, 3.7981147163269277`*^9, 3.798115013130987*^9, {
   3.7981152635381036`*^9, 3.798115277490515*^9}, 3.7981154380473537`*^9, 
   3.798115771186447*^9, 3.79811581571673*^9, 3.7981159138377075`*^9, 
   3.798115991284551*^9, 3.7981161619245577`*^9, 
   3.798116227188959*^9},ExpressionUUID->"72514eba-d8a2-4be5-8ce4-\
924f1e52223c"]
}, Open  ]]
},
WindowSize->{1620, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 281, 6, 43, "Input",ExpressionUUID->"2dfeff8c-0406-4cef-b9d7-e7356052dd96"],
Cell[842, 28, 778, 21, 43, "Input",ExpressionUUID->"a569ae8b-843d-4c77-8627-ee7825872ca4"],
Cell[1623, 51, 3359, 104, 421, "Input",ExpressionUUID->"fe1d2b0b-46b9-4dfd-a145-5c04b9041192"],
Cell[4985, 157, 415, 11, 73, "Input",ExpressionUUID->"7510eb1d-484f-4333-bd31-66cad5541bea"],
Cell[5403, 170, 517, 16, 43, "Input",ExpressionUUID->"7b376cf9-63ea-4ee6-99b7-5708bd588ec4"],
Cell[5923, 188, 6787, 164, 236, "Input",ExpressionUUID->"e8fb9a6a-73be-4535-95c8-5cd02f65a9ec"],
Cell[12713, 354, 3845, 82, 162, "Input",ExpressionUUID->"be3fb85d-a6b3-41ef-b692-bd9fb80188ca"],
Cell[16561, 438, 1150, 22, 43, "Input",ExpressionUUID->"e81f91de-5e41-4833-a09d-871ab93eed38"],
Cell[17714, 462, 969, 19, 43, "Input",ExpressionUUID->"04f96491-abf0-40f2-898c-7f1b42713431"],
Cell[18686, 483, 3843, 97, 131, "Input",ExpressionUUID->"6d9eac7d-d0e5-4ed2-967d-f138d218e960"],
Cell[CellGroupData[{
Cell[22554, 584, 1275, 28, 102, "Input",ExpressionUUID->"81a55b48-357e-4a8e-8714-974aaac0b46a"],
Cell[23832, 614, 13750, 351, 148, "Output",ExpressionUUID->"df0b6aa5-dcd2-46fc-b3c4-311dc3df06e5"],
Cell[37585, 967, 5988, 155, 141, "Output",ExpressionUUID->"72514eba-d8a2-4be5-8ce4-924f1e52223c"]
}, Open  ]]
}
]
*)

