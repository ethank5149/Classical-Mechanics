(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29671,        767]
NotebookOptionsPosition[     28469,        739]
NotebookOutlinePosition[     28845,        755]
CellTagsIndexPosition[     28802,        752]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<VariationalMethods`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assuming", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", ">", "0"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"n", ",", "Integers"}], "]"}], ",", 
     RowBox[{"i", ">", "0"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"i", ",", "Integers"}], "]"}], ",", 
     RowBox[{"j", ">", "0"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"j", ",", "Integers"}], "]"}], ",", 
     RowBox[{"l", ">", "0"}], ",", 
     RowBox[{"m", ">", "0"}], ",", 
     RowBox[{"t", ">", "0"}], ",", 
     RowBox[{"g", ">", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.798083358688701*^9, 3.7980834376125593`*^9}, {
  3.798083705812992*^9, 3.7980837084290295`*^9}, {3.7981077358599625`*^9, 
  3.7981077371159964`*^9}},ExpressionUUID->"a569ae8b-843d-4c77-8627-\
ee7825872ca4"],

Cell[BoxData[
 TemplateBox[{
  "EulerEquations","shdw",
   "\"Symbol \\!\\(\\*RowBox[{\\\"\\\\\\\"EulerEquations\\\\\\\"\\\"}]\\) \
appears in multiple contexts \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"VariationalMethods`\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"Global`\\\\\\\"\\\"}], \\\"}\\\"}]\\); definitions in context \\!\
\\(\\*RowBox[{\\\"\\\\\\\"VariationalMethods`\\\\\\\"\\\"}]\\) may shadow or \
be shadowed by other definitions.\"",2,13,2,24374573935591160062,"Local",
   "VariationalMethods`EulerEquations"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{
  3.79811570468556*^9},ExpressionUUID->"71f6b7f7-abc4-406e-bdb3-5eaf31e5bd85"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dr", "=", 
   FractionBox["l", "n"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dm", "=", 
   FractionBox["m", "n"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"q", "[", "i", "]"}], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddvars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", "i", "]"}], "''"}], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", "i_", "]"}], "[", "t_", "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"dr", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"y", "[", "i_", "]"}], "[", "t_", "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"dr", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.798051566958791*^9, 3.7980516566768723`*^9}, {
   3.798051724407429*^9, 3.7980517339492965`*^9}, {3.7980518376506577`*^9, 
   3.7980518660202312`*^9}, {3.7980519871713953`*^9, 3.798052030355604*^9}, {
   3.798052096785595*^9, 3.798052123155691*^9}, {3.798052452354372*^9, 
   3.7980524600021873`*^9}, {3.798052497197323*^9, 3.7980525722533145`*^9}, {
   3.798052677276475*^9, 3.7980527110906553`*^9}, {3.798053203323801*^9, 
   3.7980532035167956`*^9}, {3.798061127447356*^9, 3.798061171745612*^9}, {
   3.7980613676876836`*^9, 3.798061425766862*^9}, {3.798061457360426*^9, 
   3.7980614673305025`*^9}, {3.798061579102793*^9, 3.798061589455908*^9}, {
   3.7980618123185606`*^9, 3.798061834590717*^9}, {3.798061880170768*^9, 
   3.7980618872418866`*^9}, {3.7980622645345736`*^9, 
   3.7980622726947536`*^9}, {3.79806232338932*^9, 3.7980623789123588`*^9}, {
   3.79806275512401*^9, 3.798062777855998*^9}, {3.798063327066495*^9, 
   3.798063373217831*^9}, {3.7980706083190002`*^9, 3.798070612425465*^9}, {
   3.7980706960001802`*^9, 3.7980706962001715`*^9}, 3.7980775379238296`*^9, {
   3.7980790696651106`*^9, 3.798079111263296*^9}, {3.7980792287358713`*^9, 
   3.7980792298609233`*^9}, {3.79807939739404*^9, 3.7980794201137023`*^9}, {
   3.7980826393027835`*^9, 3.798082647738683*^9}, {3.7980846126221905`*^9, 
   3.7980846167407537`*^9}, {3.7980992240123634`*^9, 3.798099722399688*^9}, {
   3.7980998338479257`*^9, 3.7981001131217732`*^9}, {3.798100266819829*^9, 
   3.798100340190748*^9}, {3.7981012945979705`*^9, 3.7981013912430253`*^9}, {
   3.798101487736898*^9, 3.798101496066036*^9}, {3.7981015282002397`*^9, 
   3.798101532408559*^9}, {3.798103369582715*^9, 3.7981033731426363`*^9}, 
   3.7981045651205697`*^9, {3.798105055315899*^9, 3.7981050554989*^9}, {
   3.798105479118619*^9, 3.7981054792661*^9}, {3.79810561077676*^9, 
   3.7981056109047613`*^9}, {3.7981057662185273`*^9, 3.798105766422536*^9}, {
   3.798105882358204*^9, 3.7981058824849777`*^9}, {3.7981068969171405`*^9, 
   3.7981068989050927`*^9}, {3.798107059106216*^9, 3.7981070602926116`*^9}, {
   3.79810742366002*^9, 3.7981074249446697`*^9}, {3.7981076017997456`*^9, 
   3.798107641383374*^9}, {3.7981078175823174`*^9, 3.7981078224081736`*^9}, {
   3.7981078555412097`*^9, 3.79810785925686*^9}, {3.7981078908578925`*^9, 
   3.7981078926628942`*^9}, {3.798107956171177*^9, 3.798107959620205*^9}, {
   3.79810810038129*^9, 3.79810810949079*^9}, {3.798108701060594*^9, 
   3.798108714263418*^9}, {3.798108760075755*^9, 3.798108793755176*^9}, {
   3.7981088415783615`*^9, 3.798108858771406*^9}, {3.7981091619654627`*^9, 
   3.7981092075080423`*^9}, {3.798109596260759*^9, 3.7981095982307577`*^9}, 
   3.798109630290805*^9, {3.7981096671373096`*^9, 3.798109668606886*^9}, {
   3.7981126470847206`*^9, 3.7981126586801744`*^9}, {3.7981132700157876`*^9, 
   3.7981132712230263`*^9}, {3.798113759574812*^9, 
   3.7981137597765627`*^9}},ExpressionUUID->"735a2bac-ec06-4a5a-8eed-\
fbdf0ecef30d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kinetic", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "dm", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], "[", "t", "]"}], ",", "t"}], "]"}],
           ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}], ",", "t"}], "]"}],
           ")"}], "2"]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"potential", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"dm", " ", "g", " ", 
      RowBox[{
       RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lagrangian", "=", 
   RowBox[{"kinetic", "-", "potential"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7980520340043573`*^9, 3.7980520792296734`*^9}, {
   3.7980521368705626`*^9, 3.798052193487889*^9}, {3.798052649226946*^9, 
   3.798052655069151*^9}, 3.7980527166405287`*^9, {3.798061548177963*^9, 
   3.798061559067011*^9}, {3.7980618927819676`*^9, 3.7980619622329745`*^9}, {
   3.798062854811552*^9, 3.798062959423168*^9}, {3.7980633804697433`*^9, 
   3.798063421389962*^9}, {3.7980659205317955`*^9, 3.7980659451532497`*^9}, 
   3.7980661234544573`*^9, {3.7980663171331983`*^9, 3.7980663298758345`*^9}, 
   3.798066937910893*^9, 3.7980675923112326`*^9, {3.798068044473038*^9, 
   3.798068045354088*^9}, {3.7980691452288237`*^9, 3.798069146447886*^9}, {
   3.798069336903283*^9, 3.7980693411451445`*^9}, {3.7980791713171225`*^9, 
   3.7980791742844315`*^9}, {3.7980792104181137`*^9, 3.798079318359723*^9}, {
   3.798079442356319*^9, 3.7980794518151817`*^9}, {3.798079915753044*^9, 
   3.7980799683130875`*^9}, {3.798080154721871*^9, 3.798080167065916*^9}, {
   3.798082652693176*^9, 3.7980826544921684`*^9}, {3.798100144839035*^9, 
   3.7981002538104763`*^9}, {3.798100358071863*^9, 3.7981003591955853`*^9}, {
   3.7981014053949575`*^9, 3.798101412804943*^9}, {3.798101501190395*^9, 
   3.7981015165125*^9}, {3.7981032620932875`*^9, 3.7981032953805447`*^9}, {
   3.798103440161996*^9, 3.79810344085351*^9}, 3.798107305284296*^9, 
   3.798107435338836*^9, 3.798108149768613*^9, {3.798108181244353*^9, 
   3.798108191150861*^9}, 3.7981085980045013`*^9, {3.7981086439632635`*^9, 
   3.7981086462752686`*^9}, 3.798108929724148*^9, {3.7981092162342*^9, 
   3.7981092383418875`*^9}, 
   3.798109632418543*^9},ExpressionUUID->"4bb6dd5f-4464-41db-9ef1-\
288133c69a85"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"soln", "=", 
   RowBox[{"EulerEquations", "[", 
    RowBox[{"lagrangian", ",", "vars", ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"reducedsoln", "=", 
  RowBox[{"ddvars", "/.", 
   RowBox[{"First", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{"soln", ",", "ddvars"}], "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.798060908986391*^9, 3.798060995398444*^9}, {
   3.7980610530991344`*^9, 3.798061086097724*^9}, {3.7980616348010883`*^9, 
   3.798061674700856*^9}, {3.7980629760314746`*^9, 3.798063011657756*^9}, {
   3.79806342993291*^9, 3.7980634400229*^9}, {3.7980646949061513`*^9, 
   3.798064699349368*^9}, 3.7980669422832355`*^9, {3.7980698644403515`*^9, 
   3.798069894162403*^9}, 3.798070208297867*^9, {3.798070254998313*^9, 
   3.7980702557196217`*^9}, {3.7980703176864357`*^9, 3.798070459048811*^9}, {
   3.798070753463792*^9, 3.7980708043365173`*^9}, {3.7980709541996984`*^9, 
   3.798071013196579*^9}, {3.7980711334670887`*^9, 3.798071138106879*^9}, {
   3.798071237767801*^9, 3.7980712430698566`*^9}, {3.7980713201510596`*^9, 
   3.798071335551676*^9}, {3.798071516916443*^9, 3.798071521824213*^9}, {
   3.798071583274638*^9, 3.7980715899822083`*^9}, {3.7980720335756235`*^9, 
   3.7980720649365396`*^9}, {3.7980721018576326`*^9, 
   3.7980721111784897`*^9}, {3.7980721495202503`*^9, 
   3.7980721853274555`*^9}, {3.798072262945774*^9, 3.7980722679754505`*^9}, 
   3.798073179723075*^9, 3.798073781778674*^9, {3.798073944287504*^9, 
   3.798073947066434*^9}, {3.798073982046534*^9, 3.798073993537797*^9}, 
   3.7980740613754673`*^9, {3.798074176259554*^9, 3.7980742214091363`*^9}, {
   3.7980742769195137`*^9, 3.798074407730279*^9}, {3.7980744637084293`*^9, 
   3.7980744721893992`*^9}, 3.798080416953472*^9, 3.7980804763169365`*^9, {
   3.798082782977563*^9, 3.798082878754149*^9}, {3.798083318795003*^9, 
   3.798083338084279*^9}, 3.7980837557982564`*^9, {3.7980846672130814`*^9, 
   3.7980847639621687`*^9}, 3.798084991913288*^9, 3.7980850245759974`*^9, {
   3.7981004577951236`*^9, 3.7981004615730267`*^9}, {3.798100508883319*^9, 
   3.798100688526881*^9}, {3.798100732740102*^9, 3.7981007944869404`*^9}, {
   3.7981008752180824`*^9, 3.798100946499237*^9}, {3.7981010238977647`*^9, 
   3.7981011283629274`*^9}, {3.798101620312832*^9, 3.798101727628253*^9}, {
   3.798102708614443*^9, 3.798102771046831*^9}, {3.7981034826544495`*^9, 
   3.798103482950489*^9}, 3.798103698940392*^9, {3.7981037336102996`*^9, 
   3.798103751858859*^9}, {3.798104097932912*^9, 3.798104137353799*^9}, {
   3.798107658659498*^9, 3.7981076878914003`*^9}, {3.798107741329072*^9, 
   3.798107760234493*^9}, {3.7981077965067687`*^9, 3.7981077970699673`*^9}, {
   3.798107868569207*^9, 3.798107870105033*^9}, {3.798107900613037*^9, 
   3.798107901209985*^9}, {3.798107964027337*^9, 3.798107965220338*^9}, {
   3.798108171548473*^9, 3.7981081722155237`*^9}, {3.7981086496924286`*^9, 
   3.798108650063199*^9}, {3.7981126342354116`*^9, 3.7981126854340153`*^9}, {
   3.7981131544178953`*^9, 3.7981131574981985`*^9}, 3.798113371797563*^9, 
   3.798113777087186*^9, {3.7981149003974247`*^9, 
   3.7981149087531013`*^9}},ExpressionUUID->"e8fb9a6a-73be-4535-95c8-\
5cd02f65a9ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "g", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", "g", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"l", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"q", "[", "1", "]"}], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
        RowBox[{"l", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"q", "[", "2", "]"}], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"l", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
             RowBox[{
              RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], "2"]}], 
         ")"}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "g", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"4", " ", "g", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", "l", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"q", "[", "1", "]"}], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
        RowBox[{"l", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"q", "[", "2", "]"}], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"l", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
             RowBox[{
              RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], "2"]}], 
         ")"}]}], ")"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.798113778074023*^9, 3.7981148771908684`*^9, 
  3.7981149299247417`*^9},ExpressionUUID->"92701d9c-3b5b-46d6-9e71-\
c2c271f53ed8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dr", "=", 
   FractionBox["l", "n"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dm", "=", 
   FractionBox["m", "n"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"q", "[", "i", "]"}], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddvars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", "i", "]"}], "''"}], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", "i_", "]"}], "[", "t_", "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"dr", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"y", "[", "i_", "]"}], "[", "t_", "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"dr", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q", "[", "j", "]"}], "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kinetic", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "dm", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], "[", "t", "]"}], ",", "t"}], "]"}],
           ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}], ",", "t"}], "]"}],
           ")"}], "2"]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"potential", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"dm", " ", "g", " ", 
      RowBox[{
       RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lagrangian", "=", 
   RowBox[{"kinetic", "-", "potential"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"soln", "=", 
  RowBox[{"EulerEquations", "[", 
   RowBox[{"lagrangian", ",", "vars", ",", "t"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ddvars", "/.", 
  RowBox[{"First", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"soln", ",", "ddvars"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.798115569816735*^9, 3.798115575899243*^9}, {
   3.79811562447719*^9, 3.7981156367754974`*^9}, {3.798115670187771*^9, 
   3.7981156769060106`*^9}, 
   3.7981157250028157`*^9},ExpressionUUID->"12c29f86-0bc6-4d2b-a3a5-\
2a5e1cafcea4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "8"]}], " ", "l", " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "g", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"l", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
          RowBox[{
           RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"q", "[", "2", "]"}], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
       RowBox[{"2", " ", "l", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"q", "[", "1", "]"}], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{"l", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
          RowBox[{
           RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"q", "[", "2", "]"}], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "\[Equal]", 
    "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "8"]}], " ", "l", " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "g", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"l", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
          RowBox[{
           RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"q", "[", "1", "]"}], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
       RowBox[{"l", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
          RowBox[{
           RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"q", "[", "1", "]"}], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{"l", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"q", "[", "2", "]"}], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "\[Equal]", 
    "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.798115577664295*^9, 3.798115637250533*^9}, {
  3.798115677799138*^9, 
  3.7981157266577187`*^9}},ExpressionUUID->"3509b42d-d282-437e-83e9-\
e1d8b16c3abb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "g", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", "g", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"l", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"q", "[", "1", "]"}], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
        RowBox[{"l", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"q", "[", "2", "]"}], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"l", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
             RowBox[{
              RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], "2"]}], 
         ")"}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "g", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"4", " ", "g", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", "l", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"q", "[", "1", "]"}], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
        RowBox[{"l", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"q", "[", "2", "]"}], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"l", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "[", "1", "]"}], "[", "t", "]"}], "-", 
             RowBox[{
              RowBox[{"q", "[", "2", "]"}], "[", "t", "]"}]}], "]"}], "2"]}], 
         ")"}]}], ")"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.798115577664295*^9, 3.798115637250533*^9}, {
  3.798115677799138*^9, 
  3.79811572668369*^9}},ExpressionUUID->"95290f3f-37f0-4808-8322-\
849a4d1fa42c"]
}, Open  ]]
},
WindowSize->{808, 988},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 918, 23, 131, "Input",ExpressionUUID->"a569ae8b-843d-4c77-8627-ee7825872ca4"],
Cell[1501, 47, 670, 12, 94, "Message",ExpressionUUID->"71f6b7f7-abc4-406e-bdb3-5eaf31e5bd85"]
}, Open  ]],
Cell[2186, 62, 4580, 95, 323, "Input",ExpressionUUID->"735a2bac-ec06-4a5a-8eed-fbdf0ecef30d"],
Cell[6769, 159, 2843, 62, 184, "Input",ExpressionUUID->"4bb6dd5f-4464-41db-9ef1-288133c69a85"],
Cell[CellGroupData[{
Cell[9637, 225, 3220, 50, 73, "Input",ExpressionUUID->"e8fb9a6a-73be-4535-95c8-5cd02f65a9ec"],
Cell[12860, 277, 4636, 130, 308, "Output",ExpressionUUID->"92701d9c-3b5b-46d6-9e71-c2c271f53ed8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17533, 412, 3290, 105, 523, "Input",ExpressionUUID->"12c29f86-0bc6-4d2b-a3a5-2a5e1cafcea4"],
Cell[20826, 519, 2964, 84, 199, "Output",ExpressionUUID->"3509b42d-d282-437e-83e9-e1d8b16c3abb"],
Cell[23793, 605, 4660, 131, 308, "Output",ExpressionUUID->"95290f3f-37f0-4808-8322-849a4d1fa42c"]
}, Open  ]]
}
]
*)

